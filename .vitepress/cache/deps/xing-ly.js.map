{
  "version": 3,
  "sources": ["../../../node_modules/.pnpm/xing-ly@0.0.4/node_modules/xing-ly/dist/xing-ly.es.js"],
  "sourcesContent": ["import { defineComponent as C, ref as v, watch as D, onMounted as I, openBlock as x, createElementBlock as y, createElementVNode as t, toDisplayString as f, createCommentVNode as X, normalizeStyle as Y } from \"vue\";\nconst k = { class: \"lx-canvas\" }, A = [\"width\", \"height\"], B = {\n  key: 0,\n  class: \"canvas-info\"\n}, F = /* @__PURE__ */ t(\"td\", null, \"图片路径\", -1), L = /* @__PURE__ */ t(\"td\", null, \"缩放比例\", -1), U = /* @__PURE__ */ t(\"td\", null, \"最小限制缩放\", -1), E = /* @__PURE__ */ C({\n  __name: \"index\",\n  props: {\n    imageUrl: {\n      // 图片路径\n      type: String,\n      default: \"\"\n    },\n    height: {\n      // 定义图片展示的高度\n      type: Number,\n      default: 480\n    },\n    width: {\n      // 定义图片展示的宽度\n      type: Number,\n      default: 854\n    },\n    showInfo: {\n      type: Boolean,\n      default: !1\n    },\n    minLimitScale: {\n      type: Number,\n      default: 0.1\n    }\n  },\n  setup(i) {\n    const m = i, a = v(), u = v(), g = v(), e = v({\n      imgPos: { x: 0, y: 0 },\n      // 图片定位\n      lastMousePos: { x: 0, y: 0 },\n      // 记录上次鼠标位置\n      dragging: !1,\n      // 是否正在拖拽\n      imgScale: 1,\n      // 缩放比例\n      imgXAutoScale: 0,\n      // 图片适应拉伸宽度\n      imgYAutoScale: 0\n      // 图片适应拉伸高度\n    }), s = v({\n      display: \"none\",\n      top: \"0px\",\n      left: \"0px\"\n    });\n    function d() {\n      var l;\n      e.value.imgScale = 1, e.value.imgPos.x = 0, e.value.imgPos.y = 0, g.value = (l = a.value) == null ? void 0 : l.getContext(\"2d\"), w();\n    }\n    function w() {\n      if (!a.value)\n        throw \"canvas is null or undefined\";\n      u.value = new Image(), u.value.src = m.imageUrl, u.value.onload = function() {\n        if (!a.value)\n          throw \"canvas is null or undefined\";\n        e.value.imgXAutoScale = a.value.width / u.value.width, e.value.imgYAutoScale = a.value.height / u.value.height, r();\n      };\n    }\n    function r() {\n      if (!a.value)\n        throw \"canvas not defined\";\n      g.value.clearRect(0, 0, a.value.width, a.value.height), g.value.drawImage(\n        u.value,\n        // 规定要使用的图像、画布或视频。\n        0,\n        0,\n        // 开始剪切的 x 坐标位置。\n        u.value.width,\n        u.value.height,\n        // 被剪切图像的高度。\n        e.value.imgPos.x,\n        e.value.imgPos.y,\n        // 在画布上放置图像的x、y坐标位置。\n        u.value.width * e.value.imgScale * e.value.imgXAutoScale,\n        u.value.height * e.value.imgScale * e.value.imgYAutoScale\n        // 要使用的图像的宽度、高度\n      );\n    }\n    function S(l) {\n      if (l.preventDefault(), e.value.dragging) {\n        const n = h(l.clientX, l.clientY);\n        e.value.imgPos.x += n.x - e.value.lastMousePos.x, e.value.imgPos.y += n.y - e.value.lastMousePos.y, e.value.lastMousePos = JSON.parse(JSON.stringify(n)), r();\n      }\n    }\n    function p(l) {\n      l.preventDefault(), s.value.display = \"none\", e.value.dragging = !0, e.value.lastMousePos = h(l.clientX, l.clientY);\n    }\n    function P() {\n      e.value.dragging = !1;\n    }\n    function _() {\n      e.value.dragging = !1;\n    }\n    function M(l) {\n      l.preventDefault();\n      var n = h(l.clientX, l.clientY);\n      const c = l.wheelDelta ? l.wheelDelta : l.deltaY * -40;\n      var o = {\n        x: Number(((n.x - e.value.imgPos.x) / e.value.imgScale).toFixed(2)),\n        y: Number(((n.y - e.value.imgPos.y) / e.value.imgScale).toFixed(2))\n      };\n      c > 0 ? e.value.imgScale += 0.1 : (e.value.imgScale -= 0.1, e.value.imgScale < m.minLimitScale && (e.value.imgScale = m.minLimitScale)), e.value.imgPos.x = (1 - e.value.imgScale) * o.x + (n.x - o.x), e.value.imgPos.y = (1 - e.value.imgScale) * o.y + (n.y - o.y), r();\n    }\n    function h(l, n) {\n      var o;\n      if (!a.value)\n        throw \"canvas is null or undefined\";\n      var c = (o = a.value) == null ? void 0 : o.getBoundingClientRect();\n      return {\n        x: l - c.left - (c.width - a.value.width) / 2,\n        y: n - c.top - (c.height - a.value.height) / 2\n      };\n    }\n    function N(l) {\n      l.preventDefault(), s.value.display = \"block\", s.value.top = `${l.clientY}px`, s.value.left = `${l.clientX}px`;\n    }\n    function b() {\n      d(), s.value.display = \"none\";\n    }\n    return D(m, () => {\n      d();\n    }), I(() => {\n      d();\n    }), (l, n) => (x(), y(\"div\", k, [\n      t(\"canvas\", {\n        ref_key: \"canvas\",\n        ref: a,\n        width: i.width,\n        height: i.height,\n        onMousedown: p,\n        onMousemove: S,\n        onMouseout: _,\n        onMouseup: P,\n        onWheel: M,\n        onContextmenu: N\n      }, null, 40, A),\n      i.showInfo ? (x(), y(\"div\", B, [\n        t(\"table\", null, [\n          t(\"tr\", null, [\n            F,\n            t(\"td\", null, f(i.imageUrl), 1)\n          ]),\n          t(\"tr\", null, [\n            L,\n            t(\"td\", null, f(Number(e.value.imgScale).toFixed(2)), 1)\n          ]),\n          t(\"tr\", null, [\n            U,\n            t(\"td\", null, f(Number(i.minLimitScale).toFixed(2)), 1)\n          ])\n        ])\n      ])) : X(\"\", !0),\n      t(\"div\", {\n        class: \"context-menu\",\n        style: Y(s.value)\n      }, [\n        t(\"div\", { onClick: b }, \"还原缩放\")\n      ], 4)\n    ]));\n  }\n});\nconst O = {\n  install: function(i) {\n    i.component(\"xl-canvas-image\", E);\n  }\n};\nexport {\n  E as XlCanvasImage,\n  O as default\n};\n"],
  "mappings": "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",
  "names": []
}
